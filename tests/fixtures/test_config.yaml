version: 1

hosts:
  krx:
    base_url: https://data.krx.co.kr
    default_path: /comm/bldAttendant/getJsonData.cmd
    headers:
      User-Agent: Mozilla/5.0
      Referer: https://data.krx.co.kr/
    transport:
      request_timeout_seconds: 15
      connect_timeout_seconds: 5
      retries:
        max_retries: 2
        backoff_factor: 0.5
        retry_statuses:
          - 502
          - 503
          - 504
      rate_limit:
        requests_per_second: 1
      # curl_cffi specific options
      http_version: "2"    # "1.1" or "2"
      impersonate: "chrome101"  # optional: e.g., chrome101, safari15, firefox102
      verify_tls: true

# Endpoint registry for live calls. Parameter names, bld values, and root keys
# are taken from current KRX behavior as observed in pykrx wrappers.
endpoints:
  # 전종목시세 (MDCSTAT01501)
  stock.daily_quotes:
    host: krx
    method: POST
    path: /comm/bldAttendant/getJsonData.cmd
    bld: dbms/MDC/STAT/standard/MDCSTAT01501
    params:
      trdDd:
        type: "date(yyyymmdd)"
        required: true
      mktId:
        type: enum
        enum:
          - STK
          - KSQ
          - KNX
          - ALL
        required: true
    response:
      root_keys:
        - OutBlock_1
        - output
        - block1
      merge: append
      order_by: null

  # 개별종목시세 (MDCSTAT01701)
  stock.individual_history:
    host: krx
    method: POST
    path: /comm/bldAttendant/getJsonData.cmd
    bld: dbms/MDC/STAT/standard/MDCSTAT01701
    date_params:
      start: strtDd
      end: endDd
    chunking:
      days: 730
      gap_days: 1
    params:
      isuCd:
        type: isin
        required: true
      # 1: 단순, 2: 수정
      adjStkPrc:
        type: enum
        enum:
          - 1
          - 2
        required: true
        default: 1
    response:
      root_keys:
        - output
        - OutBlock_1
        - block1
      merge: append
      order_by: TRD_DD

  # 상장종목검색 (finder_stkisu)
  stock.search_listed:
    host: krx
    method: POST
    path: /comm/bldAttendant/getJsonData.cmd
    bld: dbms/comm/finder/finder_stkisu
    params:
      mktsel:
        type: enum
        enum:
          - STK
          - KSQ
          - ALL
        required: false
        default: ALL
      searchText:
        type: string
        required: false
        default: ""
      typeNo:
        type: int
        required: false
        default: 0
    response:
      root_keys:
        - block1
        - output
        - OutBlock_1
      merge: append
      order_by: null
